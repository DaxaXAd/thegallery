{% extends 'base.html.twig' %}

{% block title %}New Post
{% endblock %}

{% block body %}
<header>

			<div class="header_image">

				<nav class="top-bar">

					<div class="top-bar_item">
						<div class="logo-gallery">
							<a href="{{ path('app_post_index') }}" aria-label="home">
								<svg width="46" height="46" viewbox="0 0 46 46" fill="none" xmlns="http://www.w3.org/2000/svg">
									<path d="M23 6.5C23 3.46243 25.4624 1 28.5 1H39.5C42.5376 1 45 3.46243 45 6.5V17.5C45 20.5376 42.5376 23 39.5 23H34C27.9249 23 23 18.0751 23 12V6.5Z" fill="#A5380A" stroke="#08A524" stroke-width="1.61"/>
									<path d="M23 6.5C23 3.46243 20.5376 1 17.5 1H6.5C3.46243 1 1 3.46243 1 6.5V17.5C1 20.5376 3.46243 23 6.5 23H12C18.0751 23 23 18.0751 23 12V6.5Z" fill="#A5380A" stroke="#08A524" stroke-width="1.61"/>
									<path d="M23 39.5C23 42.5376 20.5376 45 17.5 45H6.5C3.46243 45 1 42.5376 1 39.5V28.5C1 25.4624 3.46243 23 6.5 23H12C18.0751 23 23 27.9249 23 34V39.5Z" fill="#A5380A" stroke="#08A524" stroke-width="1.61"/>
									<path d="M23 23H34C40.0751 23 45 27.9249 45 34V44.615C45 44.8276 44.8276 45 44.615 45H34C27.9249 45 23 40.0751 23 34V23Z" fill="#A5380A" stroke="#08A524" stroke-width="1.61"/>
								</svg>
							</a>
						</div>
						<div class="top-bar_menu">
                        {% if app.user == post.idUser %}
                            <a href="{{ path('app_user_index') }}" class="button-global" aria-label="create a post">account</a>
                        {% endif %}
							<a href="{{ path('app_contact_new')}}" class="button-global" aria-label="contact">Contact</a>
							<a href="{{ path('app_logout') }}" class="logout-btn button" aria-label="logout">Logout</a>
						</div>
					</div>

				</nav>

			
			<div class="post-container">
				<div>
					<svg class="post-logo" width="46" height="46" viewbox="0 0 46 46" fill="none" xmlns="http://www.w3.org/2000/svg">
						<path d="M23 6.5C23 3.46243 25.4624 1 28.5 1H39.5C42.5376 1 45 3.46243 45 6.5V17.5C45 20.5376 42.5376 23 39.5 23H34C27.9249 23 23 18.0751 23 12V6.5Z" fill="#A5380A" stroke="#08A524" stroke-width="1.61"/>
						<path d="M23 6.5C23 3.46243 20.5376 1 17.5 1H6.5C3.46243 1 1 3.46243 1 6.5V17.5C1 20.5376 3.46243 23 6.5 23H12C18.0751 23 23 18.0751 23 12V6.5Z" fill="#A5380A" stroke="#08A524" stroke-width="1.61"/>
						<path d="M23 39.5C23 42.5376 20.5376 45 17.5 45H6.5C3.46243 45 1 42.5376 1 39.5V28.5C1 25.4624 3.46243 23 6.5 23H12C18.0751 23 23 27.9249 23 34V39.5Z" fill="#A5380A" stroke="#08A524" stroke-width="1.61"/>
						<path d="M23 23H34C40.0751 23 45 27.9249 45 34V44.615C45 44.8276 44.8276 45 44.615 45H34C27.9249 45 23 40.0751 23 34V23Z" fill="#A5380A" stroke="#08A524" stroke-width="1.61"/>
					</svg>
				</div>
				<h1 class="post-h1">New Post</h1>
			</div>
		</div>

    </header>

<main>
    {% if app.user %}
    <div class="form_container">
        <h1>Create new Post</h1>

        {# Inclut le formulaire principal du Post (le form widget contient déjà tous les champs du PostType) #}
        {{ include('post/_form.html.twig', {'button_label': 'Save'}) }}

        {# Zone pour la preview de l'image sélectionnée, et champ caché pour stocker l'ID de l'image #}
        <input type="hidden" id="selectedImageId" name="selectedImageId" value="">
        <div id="selectedImagePreview" style="margin:10px 0; display:none;">
            <img id="previewImg" src="" alt="Selected image preview" style="max-width:200px;">
        </div>

        {# Grille des images appartenant à l'utilisateur #}
        <h2>Select an image</h2>
        <div class="image-grid">
            {% for image in images %}
                <img src="{{ asset(image.getPath()) }}" data-id="{{ image.getId() }}" alt="{{ image.getTitle() }}" class="selectable-image">
            {% else %}
                <p>No images available.</p>
            {% endfor %}
        </div>
    </div>
    {% else %}
        <h1>Access Denied</h1>
        <p>You must be logged in to create a new post.</p>
        <a href="{{ path('app_login') }}">Login</a>
    {% endif %}
</main>




{# <main>
	{% if app.user %}
	<div class="form_container">
		<h1>Create new Post</h1>
			{{ include('post/_form.html.twig') }}		
	</div>
	{% else %}
		<h1>Access Denied</h1>
		<p>You must be logged in to create a new post.</p>
		<a href="{{ path('app_login') }}">Login</a>
	{% endif %}
</main> #}
{% endblock %}
